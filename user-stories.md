# 資產配置APP - End-to-End User Stories

## 🏠 首頁與導覽

### Story 1: 查看資產總覽儀表板

**標題**: 使用者可以在首頁查看最新的資產總覽和關鍵財務指標

**BDD Use Cases**:

#### Scenario 1: 首次進入應用程式

```gherkin
Given 使用者已完成登入
When 使用者進入首頁
Then 應該看到最新日期的資產總覽
And 應該顯示總資產金額
And 應該顯示可用餘額
And 應該顯示總負債
And 應該顯示可支配淨額
And 應該顯示資產配置圓餅圖
And 應該顯示負債比例條形圖
```

#### Scenario 2: 查看空白狀態

```gherkin
Given 使用者尚未新增任何資產
When 使用者進入首頁
Then 應該看到空白狀態頁面
And 應該顯示引導文字"開始記錄您的第一筆資產"
And 應該顯示"新增資產"按鈕
```

#### Scenario 3: 查看財務警示

```gherkin
Given 使用者的信用卡債務超過5萬元
When 使用者進入首頁
Then 應該在頂部顯示紅色警示橫幅
And 警示內容為"信用卡債務過高，建議儘快還清"
And 應該顯示當前債務金額
```

-----

## 📅 時間軸管理

### Story 2: 瀏覽資產時間軸

**標題**: 使用者可以瀏覽不同時間點的資產記錄並選擇編輯

**BDD Use Cases**:

#### Scenario 1: 查看時間軸列表

```gherkin
Given 使用者已有多個時間點的資產記錄
When 使用者點擊"時間軸"頁面
Then 應該看到按日期降序排列的時間軸列表
And 每個時間點應該顯示日期
And 每個時間點應該顯示總資產金額
And 每個時間點應該顯示淨資產金額
And 每個時間點應該顯示資產筆數
And 每個時間點應該有"編輯"按鈕
```

#### Scenario 2: 選擇時間點進行編輯

```gherkin
Given 使用者在時間軸列表頁面
When 使用者點擊某個時間點的"編輯"按鈕
Then 應該導航到該時間點的資產編輯頁面
And 頁面標題應該顯示所選日期
And 應該載入該時間點的所有資產資料
```

#### Scenario 3: 查看時間軸趨勢

```gherkin
Given 使用者有超過3個時間點的資產記錄
When 使用者在時間軸頁面向下滾動
Then 應該看到簡易的趨勢圖表
And 應該顯示淨資產變化趨勢
And 應該標示增長或下降的百分比
```

-----

## ➕ 新增資產功能

### Story 3: 創建新的時間點並批次新增資產

**標題**: 使用者可以選擇日期並在同一頁面中新增多個資產

**BDD Use Cases**:

#### Scenario 1: 開始新增資產流程

```gherkin
Given 使用者在任何頁面
When 使用者點擊"新增資產"按鈕
Then 應該彈出日期選擇對話框
And 預設日期為今天
And 應該提供日曆選擇器
And 應該有"確認"和"取消"按鈕
```

#### Scenario 2: 進入批次新增表單

```gherkin
Given 使用者已選擇日期"2024-01-15"
When 使用者點擊"確認"
Then 應該導航到批次新增資產頁面
And 頁面標題應該顯示"2024-01-15 資產記錄"
And 應該顯示空的資產新增表單
And 應該有"新增更多資產"按鈕
And 應該有"保存"和"取消"按鈕
```

#### Scenario 3: 新增第一個資產

```gherkin
Given 使用者在批次新增頁面
When 使用者填寫銀行為"富邦"
And 填寫帳戶名稱為"活存"
And 填寫金額為"15000"
And 選擇資產類型為"現金類"
Then 表單應該驗證通過
And "新增更多資產"按鈕應該可用
And "保存"按鈕應該可用
```

#### Scenario 4: 新增多個資產

```gherkin
Given 使用者已填寫第一個資產
When 使用者點擊"新增更多資產"
Then 應該在下方出現新的資產表單
And 新表單應該有刪除按鈕
And 可以重複此操作新增更多資產
And 每個表單都應該有獨立的驗證
```

#### Scenario 5: 聊天式快速輸入

```gherkin
Given 使用者在批次新增頁面
When 使用者在快速輸入框輸入"新增永豐投資美股 50000"
And 按下Enter鍵
Then 應該自動解析並填入新的資產表單
And 銀行應該為"永豐投資"
And 帳戶名稱應該為"美股"
And 金額應該為"50000"
And 資產類型應該自動判斷為"投資類"
And 投資標籤應該為"美股"
```

#### Scenario 6: 儲存批次資產

```gherkin
Given 使用者已新增3個資產
When 使用者點擊"保存"按鈕
Then 應該顯示載入動畫
And 所有資產應該儲存到資料庫
And 應該產生相同的snapshot_id
And 應該導航回時間軸頁面
And 應該顯示成功訊息"已成功新增3筆資產"
```

### Story 4: 使用範本快速新增資產

**標題**: 使用者可以基於之前的記錄或範本快速建立新的資產組合

**BDD Use Cases**:

#### Scenario 1: 選擇範本

```gherkin
Given 使用者已有之前的資產記錄
When 使用者在新增資產頁面點擊"使用範本"
Then 應該顯示可用範本列表
And 應該包含"上次記錄 (2024-01-01)"
And 應該包含已儲存的自訂範本
And 應該有"不使用範本"選項
```

#### Scenario 2: 套用範本

```gherkin
Given 使用者選擇"上次記錄"範本
When 使用者點擊"套用"
Then 應該載入範本中的所有資產結構
And 所有資產的金額應該重置為0
And 其他欄位(銀行、帳戶名稱、類型)應該保持不變
And 使用者可以修改任何欄位
And 使用者可以刪除不需要的資產
```

#### Scenario 3: 另存為範本

```gherkin
Given 使用者已完成資產新增
When 使用者點擊"另存為範本"
Then 應該彈出範本命名對話框
And 預設名稱為當前日期
And 使用者輸入範本名稱"月初檢查清單"
When 使用者點擊"確認"
Then 應該儲存為可重複使用的範本
And 應該顯示"範本已儲存"訊息
```

-----

## ✏️ 編輯資產功能

### Story 5: 編輯特定時間點的資產

**標題**: 使用者可以修改、新增或刪除特定時間點的資產

**BDD Use Cases**:

#### Scenario 1: 載入時間點資產

```gherkin
Given 使用者選擇編輯"2024-01-15"的資產
When 頁面載入完成
Then 應該顯示該時間點的所有資產
And 資產應該按類型分組顯示
And 每個資產應該有"編輯"和"刪除"按鈕
And 頁面底部應該有"新增資產"按鈕
```

#### Scenario 2: 修改單一資產

```gherkin
Given 使用者在資產編輯頁面
When 使用者點擊某個資產的"編輯"按鈕
Then 該資產應該變為可編輯狀態
And 其他資產應該保持唯讀狀態
And 應該顯示"確認"和"取消"按鈕
When 使用者修改金額從"15000"改為"18000"
And 點擊"確認"
Then 資產金額應該更新
And 頁面總計應該重新計算
```

#### Scenario 3: 刪除資產

```gherkin
Given 使用者在資產編輯頁面
When 使用者點擊某個資產的"刪除"按鈕
Then 應該彈出確認對話框
And 顯示"確定要刪除此資產嗎？"
When 使用者點擊"確認刪除"
Then 該資產應該從清單中移除
And 頁面總計應該重新計算
And 應該顯示"資產已刪除"訊息
```

#### Scenario 4: 在編輯頁面新增資產

```gherkin
Given 使用者在資產編輯頁面
When 使用者點擊"新增資產"按鈕
Then 應該在頁面底部出現新的資產表單
And 新表單應該與批次新增表單相同
And 新增的資產應該屬於相同時間點
And 應該更新該時間點的總計
```

#### Scenario 5: 批次選擇操作

```gherkin
Given 使用者在資產編輯頁面有多個資產
When 使用者長按任一資產項目
Then 應該進入批次選擇模式
And 所有資產項目應該顯示核取方塊
And 頂部應該顯示已選擇的數量
And 應該顯示"刪除選中項目"按鈕
When 使用者選擇多個資產並點擊"刪除選中項目"
Then 應該彈出確認對話框顯示將刪除的資產數量
```

-----

## 📊 資料視覺化與分析

### Story 6: 查看資產配置分析

**標題**: 使用者可以查看各種圖表分析了解資產配置和趨勢

**BDD Use Cases**:

#### Scenario 1: 查看資產配置圓餅圖

```gherkin
Given 使用者有多種類型的資產
When 使用者點擊"分析"頁面
Then 應該看到資產配置圓餅圖
And 應該顯示現金類、投資類、借出款的比例
And 每個區塊應該有不同顏色
And 滑鼠懸停應該顯示具體金額和百分比
And 圖表下方應該有圖例說明
```

#### Scenario 2: 查看投資風險分析

```gherkin
Given 使用者有投資類資產
When 使用者在分析頁面滾動到投資分析區塊
Then 應該看到投資風險分佈圖
And 應該顯示高風險、中風險、低風險的比例
And 應該顯示各投資標籤(台股、美股、ETF等)的分佈
And 如果高風險投資超過30%應該顯示警告
```

#### Scenario 3: 查看資產趨勢圖

```gherkin
Given 使用者有超過5個時間點的資產記錄
When 使用者查看趨勢分析
Then 應該看到資產成長趨勢折線圖
And X軸應該為時間，Y軸應該為金額
And 應該有總資產、淨資產兩條線
And 可以點擊圖例切換顯示/隱藏特定線條
And 應該支援縮放和拖拽查看細節
```

#### Scenario 4: 查看負債分析

```gherkin
Given 使用者有負債資產
When 使用者查看負債分析區塊
Then 應該看到負債類型條形圖
And 應該區分短期負債(信用卡)和長期負債(學貸)
And 應該顯示每種負債的金額
And 如果總負債超過可用餘額應該顯示警告
```

### Story 7: 匯出和分享資料

**標題**: 使用者可以匯出資產資料或分享分析報告

**BDD Use Cases**:

#### Scenario 1: 匯出Excel格式

```gherkin
Given 使用者在任何包含資產資料的頁面
When 使用者點擊"匯出"按鈕
Then 應該顯示匯出選項選單
And 應該包含"Excel格式"選項
When 使用者選擇"Excel格式"
Then 應該下載包含所有資產資料的Excel檔案
And 檔案名稱應該包含匯出日期
And Excel應該包含多個工作表(資產明細、總結、趨勢)
```

#### Scenario 2: 匯出特定時間範圍

```gherkin
Given 使用者點擊"匯出"
When 使用者選擇"自訂範圍"
Then 應該顯示日期範圍選擇器
And 預設為過去3個月
When 使用者選擇"2024-01-01"到"2024-03-31"
And 點擊"匯出"
Then 應該只匯出該時間範圍內的資產資料
```

#### Scenario 3: 生成分析報告

```gherkin
Given 使用者在分析頁面
When 使用者點擊"生成報告"
Then 應該生成包含所有圖表的PDF報告
And 報告應該包含資產總覽、配置分析、趨勢分析
And 應該包含關鍵財務指標摘要
And 應該可以下載或分享報告
```

-----

## ⚙️ 設定與個人化

### Story 8: 管理財務警示設定

**標題**: 使用者可以設定個人化的財務警示門檻和提醒

**BDD Use Cases**:

#### Scenario 1: 設定警示門檻

```gherkin
Given 使用者在設定頁面
When 使用者點擊"財務警示設定"
Then 應該看到各種警示類型的設定選項
And 應該包含"信用卡債務警示門檻"
And 應該包含"高風險投資比例警示"
And 應該包含"淨資產為負警示"
And 每個警示都應該有開關和數值設定
```

#### Scenario 2: 修改警示門檻

```gherkin
Given 使用者在財務警示設定中
When 使用者將"信用卡債務警示門檻"從50000改為30000
And 點擊"保存"
Then 應該顯示"設定已更新"訊息
And 下次信用卡債務超過30000時應該觸發警示
```

#### Scenario 3: 測試警示功能

```gherkin
Given 使用者設定信用卡債務警示門檻為30000
When 使用者的信用卡債務達到35000
Then 在首頁應該顯示警示橫幅
And 應該發送推播通知(如果已啟用)
And 警示應該包含具體的債務金額
```

### Story 9: 管理分類和標籤

**標題**: 使用者可以自訂資產分類、投資標籤和風險等級

**BDD Use Cases**:

#### Scenario 1: 新增自訂分類

```gherkin
Given 使用者在設定頁面點擊"分類管理"
When 使用者點擊"新增分類"
Then 應該顯示新增分類表單
And 應該包含分類名稱、圖示、顏色選擇
When 使用者輸入分類名稱"虛擬貨幣"
And 選擇橙色和對應圖示
And 點擊"確認"
Then 新分類應該出現在分類列表中
And 在新增資產時應該可以選擇此分類
```

#### Scenario 2: 修改預設風險等級

```gherkin
Given 使用者在分類管理中
When 使用者點擊"台股"分類的編輯按鈕
Then 應該顯示編輯分類表單
And 應該顯示當前風險等級為"中風險"
When 使用者修改風險等級為"高風險"
And 點擊"更新"
Then 所有現有的台股資產風險等級應該自動更新
And 未來新增的台股資產預設為高風險
```

-----

## 🔐 用戶認證與安全

### Story 10: 使用者登入與資料安全

**標題**: 使用者可以安全地登入並保護個人財務資料

**BDD Use Cases**:

#### Scenario 1: Google登入

```gherkin
Given 使用者首次使用應用程式
When 使用者點擊"使用Google登入"
Then 應該開啟Google OAuth授權頁面
When 使用者完成Google授權
Then 應該自動創建用戶帳戶
And 應該導航到應用程式首頁
And 應該顯示歡迎訊息
```

#### Scenario 2: 資料備份提醒

```gherkin
Given 使用者已使用應用程式超過1個月
When 使用者登入應用程式
Then 應該偶爾顯示資料備份提醒
And 提醒內容應該說明資料儲存在雲端的安全性
And 應該提供"匯出備份"選項
And 使用者可以選擇"不再提醒"
```

#### Scenario 3: 登出確認

```gherkin
Given 使用者已登入應用程式
When 使用者點擊"登出"按鈕
Then 應該彈出確認對話框
And 顯示"確定要登出嗎？所有未儲存的變更將遺失"
When 使用者點擊"確認登出"
Then 應該清除本地資料
And 應該導航到登入頁面
```

-----

## 📱 響應式設計與使用體驗

### Story 11: 手機端優化體驗

**標題**: 使用者可以在手機上流暢地使用所有功能

**BDD Use Cases**:

#### Scenario 1: 手機版導航

```gherkin
Given 使用者在手機上開啟應用程式
When 頁面載入完成
Then 應該顯示底部導航列
And 導航列應該包含"首頁"、"時間軸"、"分析"、"設定"
And 當前頁面的圖示應該有不同顏色或樣式
And 導航列應該固定在螢幕底部
```

#### Scenario 2: 手機版表單操作

```gherkin
Given 使用者在手機上新增資產
When 使用者點擊金額輸入框
Then 應該彈出數字鍵盤
And 鍵盤應該包含小數點
When 使用者點擊銀行選擇下拉選單
Then 選項應該以全螢幕模式顯示
And 應該支援搜尋篩選
```

#### Scenario 3: 手機版圖表查看

```gherkin
Given 使用者在手機上查看分析頁面
When 使用者查看圓餅圖
Then 圖表應該自動縮放適應螢幕
And 支援雙指縮放檢視細節
And 圖例應該顯示在圖表下方
And 支援左右滑動切換不同圖表
```

### Story 12: 離線支援和同步

**標題**: 使用者可以在無網路環境下查看資料並在恢復網路後同步

**BDD Use Cases**:

#### Scenario 1: 離線查看資料

```gherkin
Given 使用者的手機失去網路連接
When 使用者開啟應用程式
Then 應該顯示最後同步的資料
And 應該在頂部顯示"離線模式"標示
And 所有查看功能應該正常運作
And 編輯功能應該被停用
```

#### Scenario 2: 離線提醒

```gherkin
Given 使用者在離線模式下
When 使用者嘗試新增或編輯資產
Then 應該顯示"目前處於離線模式，請連接網路後再試"
And 應該提供"重試連接"按鈕
And 應該建議用戶檢查網路連接
```

#### Scenario 3: 恢復網路後同步

```gherkin
Given 使用者的手機恢復網路連接
When 使用者重新進入應用程式
Then 應該自動檢查並同步資料
And 應該顯示"正在同步資料..."進度指示
And 同步完成後應該隱藏"離線模式"標示
And 如有衝突應該提醒使用者處理
```